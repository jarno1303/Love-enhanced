{% extends "base.html" %}

{% block title %}Kysymysten Validointi - Admin{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>
            <i class="fas fa-check-double text-primary me-2"></i>
            Kysymysten Validointi
        </h1>
        <a href="{{ url_for('admin_route') }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-2"></i>Takaisin Admin-paneeliin
        </a>
    </div>

    {% if questions %}
        <div class="alert alert-info">
            Löytyi <strong>{{ questions|length }}</strong> kysymystä, jotka odottavat tarkistusta.
        </div>

        {% for question in questions %}
        <div class="card mb-4 shadow-sm">
            <div class="card-header d-flex justify-content-between align-items-center">
                <div>
                    <strong>ID: {{ question.id }}</strong> | 
                    <span class="badge bg-secondary">{{ question.category }}</span> | 
                    <span class="badge 
                        {% if question.difficulty == 'helppo' %}bg-success
                        {% elif question.difficulty == 'keskivaikea' %}bg-warning text-dark
                        {% else %}bg-danger{% endif %}">
                        {{ question.difficulty }}
                    </span>
                </div>
            </div>
            <div class="card-body">
                <h5 class="card-title">{{ question.question }}</h5>
                <hr>
                <h6>Vaihtoehdot:</h6>
                <ul class="list-group mb-3">
                    {% for i in range(question.options|length) %}
                    <li class="list-group-item {% if i == question.correct %}list-group-item-success fw-bold{% endif %}">
                        <strong>{{ ['A', 'B', 'C', 'D'][i] }}.</strong> {{ question.options[i] }}
                        {% if i == question.correct %}
                            <i class="fas fa-check-circle text-success ms-2" title="Oikea vastaus"></i>
                        {% endif %}
                    </li>
                    {% endfor %}
                </ul>
                <h6>Selitys:</h6>
                <p class="border p-3 rounded bg-light">{{ question.explanation }}</p>
            </div>
            <div class="card-footer text-end bg-light">
                <a href="{{ url_for('admin_edit_question_route', question_id=question.id) }}" class="btn btn-outline-secondary btn-sm">
                    <i class="fas fa-pencil-alt me-1"></i> Muokkaa
                </a>
                <form method="POST" action="{{ url_for('admin_validate_question_action', question_id=question.id) }}" class="d-inline" onsubmit="return confirm('Haluatko varmasti validoida tämän kysymyksen?')">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn-primary btn-sm">
                        <i class="fas fa-check me-1"></i> Hyväksy ja Validoi
                    </button>
                </form>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="alert alert-success text-center p-5">
            <i class="fas fa-thumbs-up fa-3x mb-3"></i>
            <h4 class="alert-heading">Hienoa työtä!</h4>
            <p class="mb-0">Kaikki tietokannassa olevat kysymykset on validoitu.</p>
        </div>
    {% endif %}
</div>
{% endblock %}